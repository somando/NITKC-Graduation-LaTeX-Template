stages:
  - compile

platex:
  image: paperist/texlive-ja:latest
  stage: compile
  script:
    - FILES=$(find . -name "*.tex")
    - if [ ! -n "$FILES" ]; then
        echo "No tex file found. Compile skipping..."; 
        exit 0;
      fi
    - tlmgr update --self
    - tlmgr install biber biblatex
    - platex -shell-escape main.tex
    - biber main
    - platex -shell-escape main.tex
    - platex -shell-escape main.tex
    - dvipdfmx -o main.pdf main.dvi
    - rm -f *.aux *.log *.dvi *.toc *.out *.fls *.fdb_latexmk *.bbl *.bcf *.blg *.run.xml
  artifacts:
    paths:
      - "*.pdf"
    expire_in: 1 week
